library(taxizesoap)
library(taxizesoap)
library(taxize)
setwd("~/Current/Algae/Evolution of CCMs/data")
setwd("../data")
taxreturn_s <- classification(species_list, db = 'ncbi')
library(taxize)
taxreturn_s <- classification(species_list, db = 'ncbi')
library(taxize)
library(taxizesoap)
library(dplyr)
data <- read.csv("../data/mean_13c_per_species.csv")
genus_list <- data %>% distinct(genus) %>% select(genus)
genus_list <- as.character(genus_list$genus)
species_list <- data %>% distinct(truetaxa) %>% select(truetaxa)
species_list <- as.character(species_list$truetaxa)
taxreturn_g <- classification(genus_list, db = 'itis')
genus_list[1:10]
taxreturn_g <- classification(genus_list[1:10], db = 'itis')
taxreturn_g
taxreturn_g <- classification(genus_list[1:20], db = 'itis')
taxreturn_g
genus_list[1:20]
taxreturn_g <- classification(genus_list[1:20], db = 'ncbi')
taxreturn_g
taxreturn_g <- classification(genus_list[1:60], db = 'ncbi')
taxreturn_g
genus_list[60,]
genus_list[60]
taxreturn_g <- classification(genus_list, db = 'ncbi')
taxreturn_g
which(is.na(taxreturn_g))
taxreturn_g[which(is.na(taxreturn_g))]
taxreturn_g[which(is.na(taxreturn_g))][[1]]
names(taxreturn_g[which(is.na(taxreturn_g))])
names(which(is.na(taxreturn_g)))
names(which(is.na(taxreturn_g)))
taxreturn_s <- classification(species_list, db = 'ncbi')
length(names(which(is.na(taxreturn_s))))
length(species_list)
names(which(is.na(taxreturn_g)))
taxreturn_g <- classification(genus_list, db = 'bold')
taxreturn_g <- bold_search(name = genus_list)
taxreturn_g
taxreturn_g <- bold_search(name = genus_list, includeTree = TRUE)
taxreturn_g
bold_search(id=88899, dataTypes="basic")
bold_search(id=88899, dataTypes="all")
bold_search(id=88899)
bold_search(id=88899, dataTypes="basic")
bold_search(id=88899, includeTree = TRUE)
taxreturn_g
taxreturn_s <- bold_search(name = genus_list, includeTree = TRUE)
taxreturn_s <- bold_search(name = genus_list[1:10], includeTree = TRUE)
taxreturn_s
pi <- taxreturn_s$parentid
pi
bold_search(ids = pi, includeTree = TRUE)
bold_search(id = pi, includeTree = TRUE)
pi
